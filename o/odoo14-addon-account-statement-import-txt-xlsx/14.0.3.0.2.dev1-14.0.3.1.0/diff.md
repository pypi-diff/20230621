# Comparing `tmp/odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1-py3-none-any.whl.zip` & `tmp/odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,51 +1,51 @@
-Zip file size: 80640 bytes, number of entries: 49
--rw-r--r--  2.0 unx     4317 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/README.rst
--rw-r--r--  2.0 unx       43 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/__init__.py
--rw-r--r--  2.0 unx     1066 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/__manifest__.py
--rw-r--r--  2.0 unx     1058 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/data/map_data.xml
--rw-r--r--  2.0 unx    28576 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/i18n/account_bank_statement_import_txt_xlsx.pot
--rw-r--r--  2.0 unx    30852 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/i18n/account_statement_import_txt_xlsx.pot
--rw-r--r--  2.0 unx    33527 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/i18n/es_AR.po
--rw-r--r--  2.0 unx    34309 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/i18n/it.po
--rw-r--r--  2.0 unx    31898 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/i18n/nl.po
--rw-r--r--  2.0 unx    30927 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/i18n/pt.po
--rw-r--r--  2.0 unx    31981 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/i18n/zh_CN.po
--rw-r--r--  2.0 unx     1082 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/migrations/14.0.1.0.0/pre-migrate.py
--rw-r--r--  2.0 unx     1633 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/migrations/14.0.1.1.0/pre-migrate.py
--rw-r--r--  2.0 unx      240 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/models/__init__.py
--rw-r--r--  2.0 unx      562 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/models/account_journal.py
--rw-r--r--  2.0 unx     1805 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import.py
--rw-r--r--  2.0 unx     6744 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_mapping.py
--rw-r--r--  2.0 unx    15590 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_parser.py
--rw-r--r--  2.0 unx      213 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx      489 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       86 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      268 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/readme/HISTORY.rst
--rw-r--r--  2.0 unx      184 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/readme/USAGE.rst
--rw-r--r--  2.0 unx      886 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/security/ir.model.access.csv
--rw-r--r--  2.0 unx     9455 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/static/description/icon.png
--rw-r--r--  2.0 unx    15063 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/static/description/index.html
--rw-r--r--  2.0 unx      119 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/__init__.py
--rw-r--r--  2.0 unx    17982 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/test_account_statement_import_txt_xlsx.py
--rw-r--r--  2.0 unx      209 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/balance.csv
--rw-r--r--  2.0 unx      223 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/debit_credit.csv
--rw-r--r--  2.0 unx      369 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/debit_credit_amount.csv
--rw-r--r--  2.0 unx       83 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/empty_statement_en.csv
--rw-r--r--  2.0 unx     9041 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/empty_statement_en.xlsx
--rw-r--r--  2.0 unx      202 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/multi_currency.csv
--rw-r--r--  2.0 unx      160 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/original_currency.csv
--rw-r--r--  2.0 unx      144 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/original_currency_empty.csv
--rw-r--r--  2.0 unx       87 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/original_currency_no_header.csv
--rw-r--r--  2.0 unx      265 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/sample_statement_en.csv
--rw-r--r--  2.0 unx     5101 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/sample_statement_en.xlsx
--rw-r--r--  2.0 unx      670 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/views/account_journal_views.xml
--rw-r--r--  2.0 unx      837 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/views/account_statement_import.xml
--rw-r--r--  2.0 unx     5354 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/views/account_statement_import_sheet_mapping.xml
--rw-r--r--  2.0 unx      126 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/wizards/__init__.py
--rw-r--r--  2.0 unx     7140 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.py
--rw-r--r--  2.0 unx     7788 b- defN 23-May-25 02:50 odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.xml
--rw-r--r--  2.0 unx     5129 b- defN 23-May-25 02:50 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-25 02:50 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-May-25 02:50 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     6450 b- defN 23-May-25 02:50 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/RECORD
-49 files, 350430 bytes uncompressed, 69430 bytes compressed:  80.2%
+Zip file size: 80589 bytes, number of entries: 49
+-rw-r--r--  2.0 unx     4317 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/README.rst
+-rw-r--r--  2.0 unx       43 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/__init__.py
+-rw-r--r--  2.0 unx     1066 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/__manifest__.py
+-rw-r--r--  2.0 unx     1058 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/data/map_data.xml
+-rw-r--r--  2.0 unx    28576 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/i18n/account_bank_statement_import_txt_xlsx.pot
+-rw-r--r--  2.0 unx    30852 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/i18n/account_statement_import_txt_xlsx.pot
+-rw-r--r--  2.0 unx    33527 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/i18n/es_AR.po
+-rw-r--r--  2.0 unx    34309 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/i18n/it.po
+-rw-r--r--  2.0 unx    31898 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/i18n/nl.po
+-rw-r--r--  2.0 unx    30927 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/i18n/pt.po
+-rw-r--r--  2.0 unx    31981 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/i18n/zh_CN.po
+-rw-r--r--  2.0 unx     1082 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/migrations/14.0.1.0.0/pre-migrate.py
+-rw-r--r--  2.0 unx     1633 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/migrations/14.0.1.1.0/pre-migrate.py
+-rw-r--r--  2.0 unx      240 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/models/__init__.py
+-rw-r--r--  2.0 unx      562 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/models/account_journal.py
+-rw-r--r--  2.0 unx     1805 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import.py
+-rw-r--r--  2.0 unx     6744 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_mapping.py
+-rw-r--r--  2.0 unx    15273 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_parser.py
+-rw-r--r--  2.0 unx      213 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/readme/CONFIGURE.rst
+-rw-r--r--  2.0 unx      489 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       86 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      268 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/readme/HISTORY.rst
+-rw-r--r--  2.0 unx      184 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/readme/USAGE.rst
+-rw-r--r--  2.0 unx      886 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/security/ir.model.access.csv
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/static/description/icon.png
+-rw-r--r--  2.0 unx    15063 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/static/description/index.html
+-rw-r--r--  2.0 unx      119 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/__init__.py
+-rw-r--r--  2.0 unx    17982 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/test_account_statement_import_txt_xlsx.py
+-rw-r--r--  2.0 unx      209 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/balance.csv
+-rw-r--r--  2.0 unx      223 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/debit_credit.csv
+-rw-r--r--  2.0 unx      369 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/debit_credit_amount.csv
+-rw-r--r--  2.0 unx       83 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/empty_statement_en.csv
+-rw-r--r--  2.0 unx     9041 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/empty_statement_en.xlsx
+-rw-r--r--  2.0 unx      202 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/multi_currency.csv
+-rw-r--r--  2.0 unx      160 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/original_currency.csv
+-rw-r--r--  2.0 unx      144 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/original_currency_empty.csv
+-rw-r--r--  2.0 unx       87 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/original_currency_no_header.csv
+-rw-r--r--  2.0 unx      265 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/sample_statement_en.csv
+-rw-r--r--  2.0 unx     5101 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/sample_statement_en.xlsx
+-rw-r--r--  2.0 unx      670 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/views/account_journal_views.xml
+-rw-r--r--  2.0 unx      837 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/views/account_statement_import.xml
+-rw-r--r--  2.0 unx     5354 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/views/account_statement_import_sheet_mapping.xml
+-rw-r--r--  2.0 unx      126 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/wizards/__init__.py
+-rw-r--r--  2.0 unx     7140 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.py
+-rw-r--r--  2.0 unx     7788 b- defN 23-Jun-21 12:40 odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.xml
+-rw-r--r--  2.0 unx     5124 b- defN 23-Jun-21 12:40 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-21 12:40 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-21 12:40 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     6430 b- defN 23-Jun-21 12:40 odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/RECORD
+49 files, 350088 bytes uncompressed, 69419 bytes compressed:  80.2%
```

## zipnote {}

```diff
@@ -129,20 +129,20 @@
 
 Filename: odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.py
 Comment: 
 
 Filename: odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.xml
 Comment: 
 
-Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/METADATA
+Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/WHEEL
+Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/top_level.txt
+Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/RECORD
+Filename: odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/account_statement_import_txt_xlsx/__manifest__.py

```diff
@@ -1,15 +1,15 @@
 # Copyright 2019 ForgeFlow, S.L.
 # Copyright 2020 CorporateHub (https://corporatehub.eu)
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 
 {
     "name": "Bank Statement TXT/CSV/XLSX Import",
     "summary": "Import TXT/CSV or XLSX files as Bank Statements in Odoo",
-    "version": "14.0.3.0.1",
+    "version": "14.0.3.1.0",
     "category": "Accounting",
     "website": "https://github.com/OCA/bank-statement-import",
     "author": "ForgeFlow, CorporateHub, Odoo Community Association (OCA)",
     "maintainers": ["alexey-pelykh"],
     "license": "AGPL-3",
     "installable": True,
     "depends": [
```

## odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_parser.py

```diff
@@ -190,14 +190,139 @@
             else:
                 if index in values:
                     content_l.append(values[index])
         if all(isinstance(content, str) for content in content_l):
             return " ".join(content_l)
         return content_l[0]
 
+    def _parse_row(self, mapping, currency_code, values, columns):  # noqa: C901
+        timestamp = self._get_values_from_column(values, columns, "timestamp_column")
+        currency = (
+            self._get_values_from_column(values, columns, "currency_column")
+            if columns["currency_column"]
+            else currency_code
+        )
+
+        def _decimal(column_name):
+            if columns[column_name]:
+                return self._parse_decimal(
+                    self._get_values_from_column(values, columns, column_name),
+                    mapping,
+                )
+
+        amount = _decimal("amount_column")
+        if not amount:
+            amount = abs(_decimal("amount_debit_column") or 0)
+        if not amount:
+            amount = -abs(_decimal("amount_credit_column") or 0)
+
+        balance = (
+            self._get_values_from_column(values, columns, "balance_column")
+            if columns["balance_column"]
+            else None
+        )
+        original_currency = (
+            self._get_values_from_column(values, columns, "original_currency_column")
+            if columns["original_currency_column"]
+            else None
+        )
+        original_amount = (
+            self._get_values_from_column(values, columns, "original_amount_column")
+            if columns["original_amount_column"]
+            else None
+        )
+        debit_credit = (
+            self._get_values_from_column(values, columns, "debit_credit_column")
+            if columns["debit_credit_column"]
+            else None
+        )
+        transaction_id = (
+            self._get_values_from_column(values, columns, "transaction_id_column")
+            if columns["transaction_id_column"]
+            else None
+        )
+        description = (
+            self._get_values_from_column(values, columns, "description_column")
+            if columns["description_column"]
+            else None
+        )
+        notes = (
+            self._get_values_from_column(values, columns, "notes_column")
+            if columns["notes_column"]
+            else None
+        )
+        reference = (
+            self._get_values_from_column(values, columns, "reference_column")
+            if columns["reference_column"]
+            else None
+        )
+        partner_name = (
+            self._get_values_from_column(values, columns, "partner_name_column")
+            if columns["partner_name_column"]
+            else None
+        )
+        bank_name = (
+            self._get_values_from_column(values, columns, "bank_name_column")
+            if columns["bank_name_column"]
+            else None
+        )
+        bank_account = (
+            self._get_values_from_column(values, columns, "bank_account_column")
+            if columns["bank_account_column"]
+            else None
+        )
+
+        if currency != currency_code:
+            return {}
+
+        if isinstance(timestamp, str):
+            timestamp = datetime.strptime(timestamp, mapping.timestamp_format)
+
+        if balance:
+            balance = self._parse_decimal(balance, mapping)
+        else:
+            balance = None
+
+        if debit_credit:
+            amount = amount.copy_abs()
+            if debit_credit == mapping.debit_value:
+                amount = -amount
+
+        if original_amount:
+            original_amount = self._parse_decimal(original_amount, mapping).copy_sign(
+                amount
+            )
+        else:
+            original_amount = 0.0
+
+        line = {
+            "timestamp": timestamp,
+            "amount": amount,
+            "currency": currency,
+            "original_amount": original_amount,
+            "original_currency": original_currency,
+        }
+        if balance is not None:
+            line["balance"] = balance
+        if transaction_id is not None:
+            line["transaction_id"] = transaction_id
+        if description is not None:
+            line["description"] = description
+        if notes is not None:
+            line["notes"] = notes
+        if reference is not None:
+            line["reference"] = reference
+        if partner_name is not None:
+            line["partner_name"] = partner_name
+        if bank_name is not None:
+            line["bank_name"] = bank_name
+        if bank_account is not None:
+            line["bank_account"] = bank_account
+        return line
+
     def _parse_rows(self, mapping, currency_code, csv_or_xlsx, columns):  # noqa: C901
         if isinstance(csv_or_xlsx, tuple):
             rows = range(1, csv_or_xlsx[1].nrows)
         else:
             rows = csv_or_xlsx
 
         lines = []
@@ -210,142 +335,17 @@
                     cell_type = sheet.cell_type(row, col_index)
                     cell_value = sheet.cell_value(row, col_index)
                     if cell_type == xlrd.XL_CELL_DATE:
                         cell_value = xldate_as_datetime(cell_value, book.datemode)
                     values.append(cell_value)
             else:
                 values = list(row)
-
-            timestamp = self._get_values_from_column(
-                values, columns, "timestamp_column"
-            )
-            currency = (
-                self._get_values_from_column(values, columns, "currency_column")
-                if columns["currency_column"]
-                else currency_code
-            )
-
-            def _decimal(column_name):
-                if columns[column_name]:
-                    return self._parse_decimal(
-                        self._get_values_from_column(values, columns, column_name),
-                        mapping,
-                    )
-
-            amount = _decimal("amount_column")
-            if not amount:
-                amount = abs(_decimal("amount_debit_column") or 0)
-            if not amount:
-                amount = -abs(_decimal("amount_credit_column") or 0)
-
-            balance = (
-                self._get_values_from_column(values, columns, "balance_column")
-                if columns["balance_column"]
-                else None
-            )
-            original_currency = (
-                self._get_values_from_column(
-                    values, columns, "original_currency_column"
-                )
-                if columns["original_currency_column"]
-                else None
-            )
-            original_amount = (
-                self._get_values_from_column(values, columns, "original_amount_column")
-                if columns["original_amount_column"]
-                else None
-            )
-            debit_credit = (
-                self._get_values_from_column(values, columns, "debit_credit_column")
-                if columns["debit_credit_column"]
-                else None
-            )
-            transaction_id = (
-                self._get_values_from_column(values, columns, "transaction_id_column")
-                if columns["transaction_id_column"]
-                else None
-            )
-            description = (
-                self._get_values_from_column(values, columns, "description_column")
-                if columns["description_column"]
-                else None
-            )
-            notes = (
-                self._get_values_from_column(values, columns, "notes_column")
-                if columns["notes_column"]
-                else None
-            )
-            reference = (
-                self._get_values_from_column(values, columns, "reference_column")
-                if columns["reference_column"]
-                else None
-            )
-            partner_name = (
-                self._get_values_from_column(values, columns, "partner_name_column")
-                if columns["partner_name_column"]
-                else None
-            )
-            bank_name = (
-                self._get_values_from_column(values, columns, "bank_name_column")
-                if columns["bank_name_column"]
-                else None
-            )
-            bank_account = (
-                self._get_values_from_column(values, columns, "bank_account_column")
-                if columns["bank_account_column"]
-                else None
-            )
-
-            if currency != currency_code:
-                continue
-
-            if isinstance(timestamp, str):
-                timestamp = datetime.strptime(timestamp, mapping.timestamp_format)
-
-            if balance:
-                balance = self._parse_decimal(balance, mapping)
-            else:
-                balance = None
-
-            if debit_credit:
-                amount = amount.copy_abs()
-                if debit_credit == mapping.debit_value:
-                    amount = -amount
-
-            if original_amount:
-                original_amount = self._parse_decimal(
-                    original_amount, mapping
-                ).copy_sign(amount)
-            else:
-                original_amount = 0.0
-
-            line = {
-                "timestamp": timestamp,
-                "amount": amount,
-                "currency": currency,
-                "original_amount": original_amount,
-                "original_currency": original_currency,
-            }
-            if balance is not None:
-                line["balance"] = balance
-            if transaction_id is not None:
-                line["transaction_id"] = transaction_id
-            if description is not None:
-                line["description"] = description
-            if notes is not None:
-                line["notes"] = notes
-            if reference is not None:
-                line["reference"] = reference
-            if partner_name is not None:
-                line["partner_name"] = partner_name
-            if bank_name is not None:
-                line["bank_name"] = bank_name
-            if bank_account is not None:
-                line["bank_account"] = bank_account
-            lines.append(line)
+            line = self._parse_row(mapping, currency_code, values, columns)
+            if line:
+                lines.append(line)
         return lines
 
     @api.model
     def _convert_line_to_transactions(self, line):  # noqa: C901
         """Hook for extension"""
         timestamp = line["timestamp"]
         amount = line["amount"]
```

## Comparing `odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/METADATA` & `odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-account-statement-import-txt-xlsx
-Version: 14.0.3.0.2.dev1
+Version: 14.0.3.1.0
 Summary: Import TXT/CSV or XLSX files as Bank Statements in Odoo
 Home-page: https://github.com/OCA/bank-statement-import
 Author: ForgeFlow, CorporateHub, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/RECORD` & `odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/RECORD`

 * *Files 5% similar despite different names*

```diff
@@ -1,25 +1,25 @@
 odoo/addons/account_statement_import_txt_xlsx/README.rst,sha256=80xunFfZRHQmD8fYWF7rMMYm0py6IBoiLfvY5vo2hEY,4317
 odoo/addons/account_statement_import_txt_xlsx/__init__.py,sha256=0XNpxETgFdVxFDEw03O8oL3NtTSk3we-HEZW2sPKzIU,43
-odoo/addons/account_statement_import_txt_xlsx/__manifest__.py,sha256=luWV4jbMhBnS6jJSniMeVjkxnYwO4MZKQjM83DtY2vA,1066
+odoo/addons/account_statement_import_txt_xlsx/__manifest__.py,sha256=MLFqkb5SIE2g9xSvVsl7Q8ubm90xetCRGp_-GbDM7o4,1066
 odoo/addons/account_statement_import_txt_xlsx/data/map_data.xml,sha256=5EX604RbOjCMiK1Q7Psjm_Pai3-eBMZ0GunMd6vjLmk,1058
 odoo/addons/account_statement_import_txt_xlsx/i18n/account_bank_statement_import_txt_xlsx.pot,sha256=OC3Wok0ReTKCkLy6bIw2W8eFA5Aez7vj8W8QpiA71QM,28576
 odoo/addons/account_statement_import_txt_xlsx/i18n/account_statement_import_txt_xlsx.pot,sha256=ziDBSzEq9IIbDLM3c-Lf6l6NMJnssOqrFVxkKXfYf3U,30852
 odoo/addons/account_statement_import_txt_xlsx/i18n/es_AR.po,sha256=mrWxW8LCz5_hf_gA3wEv_LPgbvyvdZRQo8SKnLoqTRY,33527
 odoo/addons/account_statement_import_txt_xlsx/i18n/it.po,sha256=eUwjUB9jvbTrqFmLwPYAMnW8wf2gcID6I5fisGw7Ft0,34309
 odoo/addons/account_statement_import_txt_xlsx/i18n/nl.po,sha256=7DaR53WHeP3fSV4MO5ApevjuOK_eAbKbZscwrh72Dpk,31898
 odoo/addons/account_statement_import_txt_xlsx/i18n/pt.po,sha256=UfWfXHLNKsjGJpvpZPBeEMU4HS9uhtrKmZW8T8BAlWo,30927
 odoo/addons/account_statement_import_txt_xlsx/i18n/zh_CN.po,sha256=p-DqA0nJOxYr2t30y0TO_EYhD2seesAMO7luXPjj_Eg,31981
 odoo/addons/account_statement_import_txt_xlsx/migrations/14.0.1.0.0/pre-migrate.py,sha256=aXu0Vun9SfPr8bY0kLHBWhZYf__pGuoTi0Ch-3zVaU4,1082
 odoo/addons/account_statement_import_txt_xlsx/migrations/14.0.1.1.0/pre-migrate.py,sha256=UOSpKX8xGlRIQNvxPydq2RypfwpCTD_zHMc3J-CitYU,1633
 odoo/addons/account_statement_import_txt_xlsx/models/__init__.py,sha256=RsEvd89lQS7V0Mlk6D6FAWyOMDRd8YD0d9i4Xc-XcDo,240
 odoo/addons/account_statement_import_txt_xlsx/models/account_journal.py,sha256=F4_deAvNErZ6o1gkw9uhDrEnHyWXUKNvk09mzCVzTIw,562
 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import.py,sha256=Onjqp3guCvpG_mJVk4WviMNnHLctD4AmEVpYsZdWMKg,1805
 odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_mapping.py,sha256=zk3ocENU7rGcRMQzm3NyaAMK4JLs8wg4sJr1vJlbg7U,6744
-odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_parser.py,sha256=FFOLBgVVVBAMxBAtOOArfcoclqKY039KtlEMaarnjeY,15590
+odoo/addons/account_statement_import_txt_xlsx/models/account_statement_import_sheet_parser.py,sha256=3Xn-rNtM4yML3d1DyOW9_DhV3yrg6Qnc5ILWwFkbtPA,15273
 odoo/addons/account_statement_import_txt_xlsx/readme/CONFIGURE.rst,sha256=imX9sFGbzYnr4I07MZvHBZyyhBm8pLZ6AmpKNVY6zR4,213
 odoo/addons/account_statement_import_txt_xlsx/readme/CONTRIBUTORS.rst,sha256=wshMZm_kBKAzVDsi-b7k-HOQ5cPodeOhZuwJMwSKQoU,489
 odoo/addons/account_statement_import_txt_xlsx/readme/DESCRIPTION.rst,sha256=lHrjCbQdpNU9QhA9vwxyRgJWJHk87YujRn6P8L2Ha3A,86
 odoo/addons/account_statement_import_txt_xlsx/readme/HISTORY.rst,sha256=XHPod20o8aWCowA99NgcDKgl7r8v41_wy_MXxLhTKNQ,268
 odoo/addons/account_statement_import_txt_xlsx/readme/USAGE.rst,sha256=5wVe6CMUaGqAsE-yxAuc03YSxIFnRQ9mHeFkw-UBI68,184
 odoo/addons/account_statement_import_txt_xlsx/security/ir.model.access.csv,sha256=Rut_0-T2Zvl4lScSm6TyzP45d3v0dhVxvDWUedjB9Zg,886
 odoo/addons/account_statement_import_txt_xlsx/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
@@ -39,11 +39,11 @@
 odoo/addons/account_statement_import_txt_xlsx/tests/fixtures/sample_statement_en.xlsx,sha256=eOpaIIiKh6hTE_ebGwCgIaJBpoehKEQAqrXjHiMklVQ,5101
 odoo/addons/account_statement_import_txt_xlsx/views/account_journal_views.xml,sha256=iROLliBEfXvtXNsyHg5Ycvx9Rw9uuNWaXxdJsk8V1V4,670
 odoo/addons/account_statement_import_txt_xlsx/views/account_statement_import.xml,sha256=mKG_YF5xTGaNgYT0xRaIeK72DiiSnrLEkb1JNnZfyvk,837
 odoo/addons/account_statement_import_txt_xlsx/views/account_statement_import_sheet_mapping.xml,sha256=TdOSTGy_RMrHis8KyoHobc6T57NfcRHA7MgtEbUjbzQ,5354
 odoo/addons/account_statement_import_txt_xlsx/wizards/__init__.py,sha256=QHxM4GUhm-T0LBwCyi0D4X03qJgX76Axx7vjNWUEeeE,126
 odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.py,sha256=5i_wjH1MxRnDaUWD5HD26Aa3eMMWNYm_jL2aVpX8BlU,7140
 odoo/addons/account_statement_import_txt_xlsx/wizards/account_statement_import_sheet_mapping_wizard.xml,sha256=ewYg_FtiN5KhFg91ZKccGZfrMEqbspO5Bn6pUmsoX34,7788
-odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/METADATA,sha256=iV08cgaUBYSs_7_NBHDmNUXivRt9SPOB3F1IL4vc4jQ,5129
-odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_account_statement_import_txt_xlsx-14.0.3.0.2.dev1.dist-info/RECORD,,
+odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/METADATA,sha256=tqWjulxJ9Ld3cicmSADkGJZrOWzQslmEqDbyMAaTE5I,5124
+odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_account_statement_import_txt_xlsx-14.0.3.1.0.dist-info/RECORD,,
```

