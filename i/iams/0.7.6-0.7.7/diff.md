# Comparing `tmp/iams-0.7.6-py3-none-any.whl.zip` & `tmp/iams-0.7.7-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,67 +1,69 @@
-Zip file size: 83293 bytes, number of entries: 65
--rw-r--r--  2.0 unx     1954 b- defN 23-May-06 11:29 iams/__init__.py
--rw-r--r--  2.0 unx     8055 b- defN 23-May-06 11:29 iams/agent.py
--rw-r--r--  2.0 unx     3050 b- defN 23-May-06 11:29 iams/ca.py
--rw-r--r--  2.0 unx      175 b- defN 23-May-06 11:29 iams/constants.py
--rw-r--r--  2.0 unx      579 b- defN 23-May-06 11:29 iams/df.py
--rw-r--r--  2.0 unx      682 b- defN 23-May-06 11:29 iams/exceptions.py
--rw-r--r--  2.0 unx     2815 b- defN 23-May-06 11:29 iams/helper.py
--rw-r--r--  2.0 unx    17134 b- defN 23-May-06 11:29 iams/runtime.py
--rw-r--r--  2.0 unx     5370 b- defN 23-May-06 11:29 iams/server.py
--rw-r--r--  2.0 unx     9282 b- defN 23-May-06 11:29 iams/servicer.py
--rw-r--r--  2.0 unx    10491 b- defN 23-May-06 11:29 iams/simulation.py
--rw-r--r--  2.0 unx     3848 b- defN 23-May-06 11:29 iams/stub.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/aio/__init__.py
--rw-r--r--  2.0 unx    14395 b- defN 23-May-06 11:29 iams/aio/grpc.py
--rw-r--r--  2.0 unx     4102 b- defN 23-May-06 11:29 iams/aio/influx.py
--rw-r--r--  2.0 unx     4768 b- defN 23-May-06 11:29 iams/aio/interfaces.py
--rw-r--r--  2.0 unx     5060 b- defN 23-May-06 11:29 iams/aio/manager.py
--rw-r--r--  2.0 unx     4938 b- defN 23-May-06 11:29 iams/aio/mqtt.py
--rw-r--r--  2.0 unx    12569 b- defN 23-May-06 11:29 iams/aio/opcua.py
--rw-r--r--  2.0 unx     5976 b- defN 23-May-06 11:29 iams/aio/tcp.py
--rw-r--r--  2.0 unx     8378 b- defN 23-May-06 11:29 iams/aio/zeebe.py
--rw-r--r--  2.0 unx      755 b- defN 23-May-06 11:29 iams/interfaces/__init__.py
--rw-r--r--  2.0 unx     1097 b- defN 23-May-06 11:29 iams/interfaces/ca.py
--rw-r--r--  2.0 unx     1920 b- defN 23-May-06 11:29 iams/interfaces/channel.py
--rw-r--r--  2.0 unx     1155 b- defN 23-May-06 11:29 iams/interfaces/df.py
--rw-r--r--  2.0 unx     2133 b- defN 23-May-06 11:29 iams/interfaces/plugin.py
--rw-r--r--  2.0 unx     2301 b- defN 23-May-06 11:29 iams/interfaces/runtime.py
--rw-r--r--  2.0 unx    21681 b- defN 23-May-06 11:29 iams/interfaces/scheduler.py
--rw-r--r--  2.0 unx    10739 b- defN 23-May-06 11:29 iams/interfaces/simulation.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/plugins/arango/__init__.py
--rw-r--r--  2.0 unx      942 b- defN 23-May-06 11:29 iams/plugins/arango/plugin.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/plugins/envoy/__init__.py
--rw-r--r--  2.0 unx      364 b- defN 23-May-06 11:29 iams/plugins/envoy/plugin.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/plugins/fluentd/__init__.py
--rw-r--r--  2.0 unx      967 b- defN 23-May-06 11:29 iams/plugins/fluentd/plugin.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/plugins/influxdb/__init__.py
--rw-r--r--  2.0 unx     1770 b- defN 23-May-06 11:29 iams/plugins/influxdb/plugin.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/plugins/mqtt/__init__.py
--rw-r--r--  2.0 unx      938 b- defN 23-May-06 11:29 iams/plugins/mqtt/plugin.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/plugins/sentry/__init__.py
--rw-r--r--  2.0 unx      712 b- defN 23-May-06 11:29 iams/plugins/sentry/plugin.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/proto/__init__.py
--rw-r--r--  2.0 unx     3388 b- defN 23-May-06 11:29 iams/proto/agent_pb2.py
--rw-r--r--  2.0 unx     9972 b- defN 23-May-06 11:29 iams/proto/agent_pb2_grpc.py
--rw-r--r--  2.0 unx     1350 b- defN 23-May-06 11:29 iams/proto/ca_pb2.py
--rw-r--r--  2.0 unx     2396 b- defN 23-May-06 11:29 iams/proto/ca_pb2_grpc.py
--rw-r--r--  2.0 unx      944 b- defN 23-May-06 11:29 iams/proto/df_pb2.py
--rw-r--r--  2.0 unx     1027 b- defN 23-May-06 11:29 iams/proto/df_pb2_grpc.py
--rw-r--r--  2.0 unx     3382 b- defN 23-May-06 11:29 iams/proto/framework_pb2.py
--rw-r--r--  2.0 unx    16371 b- defN 23-May-06 11:29 iams/proto/framework_pb2_grpc.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-06 11:29 iams/utils/__init__.py
--rw-r--r--  2.0 unx    15470 b- defN 23-May-06 11:29 iams/utils/arangodb.py
--rw-r--r--  2.0 unx     6693 b- defN 23-May-06 11:29 iams/utils/grpc.py
--rw-r--r--  2.0 unx      824 b- defN 23-May-06 11:29 iams/utils/outliner.py
--rw-r--r--  2.0 unx     4273 b- defN 23-May-06 11:29 iams/utils/plotting.py
--rw-r--r--  2.0 unx     1905 b- defN 23-May-06 11:29 iams/utils/plugins.py
--rw-r--r--  2.0 unx    23518 b- defN 23-May-06 11:29 iams/utils/scheduler.py
--rw-r--r--  2.0 unx      184 b- defN 23-May-06 11:29 iams/utils/simulation.py
--rw-r--r--  2.0 unx      898 b- defN 23-May-06 11:29 iams/utils/ssl.py
--rw-r--r--  2.0 unx    16725 b- defN 23-May-06 11:29 iams-0.7.6.dist-info/LICENSE
--rw-r--r--  2.0 unx     4270 b- defN 23-May-06 11:29 iams-0.7.6.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-May-06 11:29 iams-0.7.6.dist-info/WHEEL
--rw-r--r--  2.0 unx      120 b- defN 23-May-06 11:29 iams-0.7.6.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        5 b- defN 23-May-06 11:29 iams-0.7.6.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     5105 b- defN 23-May-06 11:29 iams-0.7.6.dist-info/RECORD
-65 files, 290007 bytes uncompressed, 75351 bytes compressed:  74.0%
+Zip file size: 84563 bytes, number of entries: 67
+-rw-r--r--  2.0 unx     1954 b- defN 23-Jun-21 06:33 iams/__init__.py
+-rw-r--r--  2.0 unx     8055 b- defN 23-Jun-21 06:33 iams/agent.py
+-rw-r--r--  2.0 unx     3050 b- defN 23-Jun-21 06:33 iams/ca.py
+-rw-r--r--  2.0 unx      175 b- defN 23-Jun-21 06:33 iams/constants.py
+-rw-r--r--  2.0 unx      579 b- defN 23-Jun-21 06:33 iams/df.py
+-rw-r--r--  2.0 unx      682 b- defN 23-Jun-21 06:33 iams/exceptions.py
+-rw-r--r--  2.0 unx     2815 b- defN 23-Jun-21 06:33 iams/helper.py
+-rw-r--r--  2.0 unx    17134 b- defN 23-Jun-21 06:33 iams/runtime.py
+-rw-r--r--  2.0 unx     5370 b- defN 23-Jun-21 06:33 iams/server.py
+-rw-r--r--  2.0 unx     9282 b- defN 23-Jun-21 06:33 iams/servicer.py
+-rw-r--r--  2.0 unx    10491 b- defN 23-Jun-21 06:33 iams/simulation.py
+-rw-r--r--  2.0 unx     3848 b- defN 23-Jun-21 06:33 iams/stub.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/aio/__init__.py
+-rw-r--r--  2.0 unx    14967 b- defN 23-Jun-21 06:33 iams/aio/grpc.py
+-rw-r--r--  2.0 unx     4102 b- defN 23-Jun-21 06:33 iams/aio/influx.py
+-rw-r--r--  2.0 unx     4768 b- defN 23-Jun-21 06:33 iams/aio/interfaces.py
+-rw-r--r--  2.0 unx     5060 b- defN 23-Jun-21 06:33 iams/aio/manager.py
+-rw-r--r--  2.0 unx     4938 b- defN 23-Jun-21 06:33 iams/aio/mqtt.py
+-rw-r--r--  2.0 unx    12569 b- defN 23-Jun-21 06:33 iams/aio/opcua.py
+-rw-r--r--  2.0 unx     5976 b- defN 23-Jun-21 06:33 iams/aio/tcp.py
+-rw-r--r--  2.0 unx     9911 b- defN 23-Jun-21 06:33 iams/aio/zeebe.py
+-rw-r--r--  2.0 unx      755 b- defN 23-Jun-21 06:33 iams/interfaces/__init__.py
+-rw-r--r--  2.0 unx     1097 b- defN 23-Jun-21 06:33 iams/interfaces/ca.py
+-rw-r--r--  2.0 unx     1920 b- defN 23-Jun-21 06:33 iams/interfaces/channel.py
+-rw-r--r--  2.0 unx     1155 b- defN 23-Jun-21 06:33 iams/interfaces/df.py
+-rw-r--r--  2.0 unx     2133 b- defN 23-Jun-21 06:33 iams/interfaces/plugin.py
+-rw-r--r--  2.0 unx     2301 b- defN 23-Jun-21 06:33 iams/interfaces/runtime.py
+-rw-r--r--  2.0 unx    21681 b- defN 23-Jun-21 06:33 iams/interfaces/scheduler.py
+-rw-r--r--  2.0 unx    10739 b- defN 23-Jun-21 06:33 iams/interfaces/simulation.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/plugins/arango/__init__.py
+-rw-r--r--  2.0 unx      942 b- defN 23-Jun-21 06:33 iams/plugins/arango/plugin.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/plugins/envoy/__init__.py
+-rw-r--r--  2.0 unx      364 b- defN 23-Jun-21 06:33 iams/plugins/envoy/plugin.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/plugins/fluentd/__init__.py
+-rw-r--r--  2.0 unx      967 b- defN 23-Jun-21 06:33 iams/plugins/fluentd/plugin.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/plugins/influxdb/__init__.py
+-rw-r--r--  2.0 unx     1770 b- defN 23-Jun-21 06:33 iams/plugins/influxdb/plugin.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/plugins/mqtt/__init__.py
+-rw-r--r--  2.0 unx      938 b- defN 23-Jun-21 06:33 iams/plugins/mqtt/plugin.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/plugins/sentry/__init__.py
+-rw-r--r--  2.0 unx      712 b- defN 23-Jun-21 06:33 iams/plugins/sentry/plugin.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/plugins/zeebe/__init__.py
+-rw-r--r--  2.0 unx      933 b- defN 23-Jun-21 06:33 iams/plugins/zeebe/plugin.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/proto/__init__.py
+-rw-r--r--  2.0 unx     3388 b- defN 23-Jun-21 06:33 iams/proto/agent_pb2.py
+-rw-r--r--  2.0 unx     9972 b- defN 23-Jun-21 06:33 iams/proto/agent_pb2_grpc.py
+-rw-r--r--  2.0 unx     1350 b- defN 23-Jun-21 06:33 iams/proto/ca_pb2.py
+-rw-r--r--  2.0 unx     2396 b- defN 23-Jun-21 06:33 iams/proto/ca_pb2_grpc.py
+-rw-r--r--  2.0 unx      944 b- defN 23-Jun-21 06:33 iams/proto/df_pb2.py
+-rw-r--r--  2.0 unx     1027 b- defN 23-Jun-21 06:33 iams/proto/df_pb2_grpc.py
+-rw-r--r--  2.0 unx     3382 b- defN 23-Jun-21 06:33 iams/proto/framework_pb2.py
+-rw-r--r--  2.0 unx    16371 b- defN 23-Jun-21 06:33 iams/proto/framework_pb2_grpc.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-21 06:33 iams/utils/__init__.py
+-rw-r--r--  2.0 unx    15470 b- defN 23-Jun-21 06:33 iams/utils/arangodb.py
+-rw-r--r--  2.0 unx     6693 b- defN 23-Jun-21 06:33 iams/utils/grpc.py
+-rw-r--r--  2.0 unx      824 b- defN 23-Jun-21 06:33 iams/utils/outliner.py
+-rw-r--r--  2.0 unx     4273 b- defN 23-Jun-21 06:33 iams/utils/plotting.py
+-rw-r--r--  2.0 unx     1905 b- defN 23-Jun-21 06:33 iams/utils/plugins.py
+-rw-r--r--  2.0 unx    23518 b- defN 23-Jun-21 06:33 iams/utils/scheduler.py
+-rw-r--r--  2.0 unx      184 b- defN 23-Jun-21 06:33 iams/utils/simulation.py
+-rw-r--r--  2.0 unx      898 b- defN 23-Jun-21 06:33 iams/utils/ssl.py
+-rw-r--r--  2.0 unx    16725 b- defN 23-Jun-21 06:33 iams-0.7.7.dist-info/LICENSE
+-rw-r--r--  2.0 unx     4220 b- defN 23-Jun-21 06:33 iams-0.7.7.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-21 06:33 iams-0.7.7.dist-info/WHEEL
+-rw-r--r--  2.0 unx      120 b- defN 23-Jun-21 06:33 iams-0.7.7.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-21 06:33 iams-0.7.7.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     5273 b- defN 23-Jun-21 06:33 iams-0.7.7.dist-info/RECORD
+67 files, 293163 bytes uncompressed, 76353 bytes compressed:  74.0%
```

## zipnote {}

```diff
@@ -117,14 +117,20 @@
 
 Filename: iams/plugins/sentry/__init__.py
 Comment: 
 
 Filename: iams/plugins/sentry/plugin.py
 Comment: 
 
+Filename: iams/plugins/zeebe/__init__.py
+Comment: 
+
+Filename: iams/plugins/zeebe/plugin.py
+Comment: 
+
 Filename: iams/proto/__init__.py
 Comment: 
 
 Filename: iams/proto/agent_pb2.py
 Comment: 
 
 Filename: iams/proto/agent_pb2_grpc.py
@@ -171,26 +177,26 @@
 
 Filename: iams/utils/simulation.py
 Comment: 
 
 Filename: iams/utils/ssl.py
 Comment: 
 
-Filename: iams-0.7.6.dist-info/LICENSE
+Filename: iams-0.7.7.dist-info/LICENSE
 Comment: 
 
-Filename: iams-0.7.6.dist-info/METADATA
+Filename: iams-0.7.7.dist-info/METADATA
 Comment: 
 
-Filename: iams-0.7.6.dist-info/WHEEL
+Filename: iams-0.7.7.dist-info/WHEEL
 Comment: 
 
-Filename: iams-0.7.6.dist-info/entry_points.txt
+Filename: iams-0.7.7.dist-info/entry_points.txt
 Comment: 
 
-Filename: iams-0.7.6.dist-info/top_level.txt
+Filename: iams-0.7.7.dist-info/top_level.txt
 Comment: 
 
-Filename: iams-0.7.6.dist-info/RECORD
+Filename: iams-0.7.7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## iams/__init__.py

```diff
@@ -3,15 +3,15 @@
 
 """
 Industrial agent management system
 """
 
 from functools import lru_cache
 
-VERSION = ((0, 7, 6), ('final', 0))
+VERSION = ((0, 7, 7), ('final', 0))
 
 
 @lru_cache(maxsize=8)
 def get_version(dev=True, short=False):
     """
     return a version number consistent with PEP386
     """
```

## iams/aio/grpc.py

```diff
@@ -290,14 +290,32 @@
 
     def __hash__(self):
         return hash(self.name)
 
     def __str__(self):
         return self.name
 
+    def __eq__(self, other):
+        return hash(self) == hash(other)
+
+    def __ne__(self, other):
+        return not hash(self) == hash(other)
+
+    def __gt__(self, other):
+        return hash(self) > hash(other)
+
+    def __lt__(self, other):
+        return hash(self) < hash(other)
+
+    def __gte__(self, other):
+        return hash(self) >= hash(other)
+
+    def __lte__(self, other):
+        return hash(self) <= hash(other)
+
     def __repr__(self):
         return f"<{self.__class__.__qualname__}({self.name})>"
 
     async def __call__(self):
         """
         starts the coroutine
         """
@@ -371,14 +389,19 @@
         """
 
     async def disconnect(self):
         """
         disconnect callback
         """
 
+    async def cleanup(self):
+        """
+        cleanup when task was closed
+        """
+
     async def _main(self):
         """
         manages the connection
         """
         wait = 0
         kwargs = {
             'hostname': self.hostname,
@@ -429,7 +452,10 @@
 
         except asyncio.CancelledError:
             pass
 
         except Exception:
             logger.exception('Error in %s._main', self.__class__.__qualname__)
             raise
+
+        finally:
+            await self.cleanup()
```

## iams/aio/zeebe.py

```diff
@@ -29,84 +29,133 @@
     from pyzeebe.errors import ProcessInstanceNotFoundError
     from pyzeebe.errors import UnkownGrpcStatusCodeError
     from pyzeebe.errors import ZeebeBackPressureError
     from pyzeebe.errors import ZeebeGatewayUnavailableError
     from pyzeebe.errors import ZeebeInternalError
 except ImportError:  # pragma: no branch
     logger.exception("Could not import opcua library")
+    Job = None
     ENABLE = False
 else:
     ENABLE = True
 
 if HOST is None:
     logger.info("ZEEBE_HOST is not specified")
     ENABLE = False
 
 
-class ZeebeCoroutine(Coroutine):
+class JobAlreadyRunningError(Exception):
+    """
+    Error thrown, when job is already processed by the agent
+    """
+
+
+class ZeebeCoroutine(Coroutine):  # pylint: disable=too-many-instance-attributes
     """
     Zeebe Coroutine
     """
 
     # pylint: disable=too-many-arguments,dangerous-default-value
-    def __init__(self, parent, host: str, port: int = 26500, channel_options: dict = {}, task_type: str = None):
+    def __init__(self, parent, host: str, port: int = 26501,
+                 channel_options: dict = {}, task_type: str = None):
         logger.debug("Initialize Zeebe coroutine")
         self._adapter = None
         self._channel = None
         self._channel_kwargs = {
             'hostname': host,
             'port': port,
             'channel_options': channel_options,
         }
         self._client = None
+        self._jobs = {}
+        self._loop = None
         self._parent = parent
         self._task_type = task_type or f'agent:{self._parent.iams.agent}'
+        self._watch = {}
         self._worker = None
 
     async def setup(self, executor):
         """
         setup method is awaited one at the start of the coroutines
         """
-        logger.debug(
-            "Create zeebe worker client with address=%s",
+        logger.info(
+            "Create zeebe worker client with address=%s listening to task_type=%s",
             self._channel_kwargs['hostname'],
+            self._task_type,
         )
         self._channel = create_insecure_channel(**self._channel_kwargs)
         self._client = ZeebeClient(self._channel)
-        self._worker = ZeebeWorker(self._channel, name=NAME)
+        self._worker = ZeebeWorker(self._channel, name=NAME, max_connection_retries=-1)
+        self._loop = asyncio.get_running_loop()
 
-        @self._worker.task(task_type=self._task_type, single_value=True, variable_name="agent_data")
-        async def callback(job: Job, agent_data: dict):
-            await self._parent.zeebe_update_process(job.process_instance_key, agent_data, job.custom_headers, False)
-            await self._parent.zeebe_callback(job, agent_data)
+        @self._worker.task(
+            task_type=self._task_type,
+            exception_handler=self.exception_handler,
+            **self._parent.zeebe_worker_options(),
+        )
+        async def callback(job: Job, agent_instance_variables: dict):
+
+            if job.key in self._jobs:
+                self._watch[job.key].cancel()
+                self._watch[job.key] = self._loop.call_later(120, self._jobs[job.key].cancel)
+                raise JobAlreadyRunningError("Job already running")
+
+            self._jobs[job.key] = asyncio.create_task(self._parent.zeebe_callback(
+                agent_instance_variables,
+                job.custom_headers,
+                job.process_instance_key,
+                job.key,
+            ), name=f"zeebe-job:{job.key}")
+
+            # set watchdog and cancel the job if zeebe server did not update the worker for 120 seconds
+            self._watch[job.key] = self._loop.call_later(120, self._jobs[job.key].cancel)
+
+            # wait for response, cleanup and return
+            result = await self._jobs[job.key]
+            self._watch[job.key].cancel()
+            del self._jobs[job.key]
+            del self._watch[job.key]
+            return result
+
+    @staticmethod
+    async def exception_handler(exception: Exception, job: Job) -> None:
+        """
+        Exception handler for zeebe
+        """
+        if isinstance(exception, JobAlreadyRunningError):
+            return
+        logger.info("Failed to run task %s. Reason: %s", job.type, exception, exc_info=True)
 
-    async def start_process(self, process_id: str, variables: dict, version: int = -1):
+    async def start_process(self, process_id: str, variables: dict, version: int = -1) -> int:
         """
         Start a process in zeebe gateway
         """
         variables['task_type'] = self._task_type
-        if "agent_data" not in variables:
-            variables['agent_data'] = None
+        if "agent_instance_variables" not in variables:
+            variables['agent_instance_variables'] = None
 
         wait = 0
         while True:
             try:
                 instance_key = await self._client.run_process(process_id, variables, version)
                 break
             except (ProcessDefinitionNotFoundError, InvalidJSONError, ProcessDefinitionHasNoStartEventError):
                 logger.exception("Zeebe process error")
-                return False
+                return 0
             except (ZeebeBackPressureError, ZeebeGatewayUnavailableError, ZeebeInternalError, UnkownGrpcStatusCodeError) as exc:  # noqa: E501
                 wait = min(60, wait + 1)
                 logger.info("Waiting Zeebe got an error: '%s' - wait %s seconds to retry", exc, wait)
                 await asyncio.sleep(wait)
 
-        logger.debug("New process started with id=%s and agent_data=%s", instance_key, variables['agent_data'])
-        await self._parent.zeebe_update_process(instance_key, variables['agent_data'], {}, True)
-        return True
+        logger.debug(
+            "New process started with id=%s and agent_instance_variables=%s",
+            instance_key,
+            variables['agent_instance_variables'],
+        )
+        return instance_key
 
     async def cancel_process(self, instance_key: int) -> None:
         """
         Cancel a running process instance
 
         returns True on success and False on failure
         """
@@ -119,15 +168,15 @@
                 return
             except (ZeebeBackPressureError, ZeebeGatewayUnavailableError, ZeebeInternalError, UnkownGrpcStatusCodeError) as exc:  # noqa: E501
                 wait = min(60, wait + 1)
                 logger.info("Waiting Zeebe got an error: '%s' - wait %s seconds to retry", exc, wait)
                 await asyncio.sleep(wait)
 
     # pylint: disable=too-many-arguments
-    async def send_message(self, name: str, variables: dict, message_id: str, ttl: int, correlation_key: str):
+    async def send_message(self, name: str, variables: dict, message_id: str, ttl: int, correlation_key: str) -> bool:
         """
         send message to zeebe gateway
         """
         if not correlation_key:
             correlation_key = self._task_type
 
         wait = 0
@@ -178,37 +227,37 @@
 
     def zeebe_channel_options(self) -> dict:  # pylint: disable=no-self-use
         """
         returns the grpc channel options for zeebe gateway
         """
         return {}
 
+    def zeebe_worker_options(self) -> dict:  # pylint: disable=no-self-use
+        """
+        returns the zebee worker options
+        """
+        return {
+            'single_value': True,
+            'variable_name': "agent_instance_variables",
+        }
+
     async def zeebe_start_process(self, process_id: str, variables: dict, version: int = -1) -> bool:
         """
         starts a zeebe process, returns true when the process was started or false when it was not started
         """
         if self._zeebe is None:
             return False
         return await self._zeebe.start_process(process_id, variables, version)
 
-    async def zeebe_callback(self, job: Job, data: dict):
+    async def zeebe_callback(self, variables: dict, headers: dict, process_instance_key: int, job_key: int):
         """
         implements a zeebe worker for this agent. gets the job and the state of the BPMN diagram
         returns the new state of the BPMN diagram
         """
 
-    # pylint: disable=no-self-use,unused-argument
-    async def zeebe_update_process(self, instance_key, agent_data, headers, created):
-        """
-        callback that can be used to update the process data. Gets the instance key, agent_data, headers
-        and the info if the process was created or updated.
-        returns True on success and False on failure
-        """
-        return True
-
     async def zeebe_cancel_process(self, instance_key):
         """
         Cancels a process with by instance_key
         returns True on success and False on failure
         """
         if self._zeebe is None:
             return False
```

## Comparing `iams-0.7.6.dist-info/LICENSE` & `iams-0.7.7.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `iams-0.7.6.dist-info/METADATA` & `iams-0.7.7.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,35 +1,34 @@
 Metadata-Version: 2.1
 Name: iams
-Version: 0.7.6
+Version: 0.7.7
 Summary: An industial agent management system aiming to control agents for manufacturing units.
 Home-page: https://github.com/glomium/industrial-ams
 Author: Sebastian Braun
 Author-email: sebastian.braun@fh-aachen.de
 Project-URL: Documentation, https://github.com/glomium/industrial-ams
 Project-URL: Source, https://github.com/glomium/industrial-ams
 Project-URL: Tracker, https://github.com/glomium/industrial-ams
 Classifier: Development Status :: 4 - Beta
 Classifier: Intended Audience :: Information Technology
 Classifier: Intended Audience :: Manufacturing
 Classifier: Intended Audience :: Science/Research
 Classifier: License :: OSI Approved :: Mozilla Public License 2.0 (MPL 2.0)
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python :: 3 :: Only
-Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Requires-Python: >=3.8
 Description-Content-Type: text/x-rst
 License-File: LICENSE
 Requires-Dist: PyYAML (==6.0)
 Requires-Dist: aiohttp[speedups] (==3.8.4)
-Requires-Dist: cryptography (==40.0.2)
-Requires-Dist: docker (==6.1.0)
+Requires-Dist: cryptography (==41.0.1)
+Requires-Dist: docker (==6.1.3)
 Requires-Dist: grpcio-tools (==1.51.3)
 Requires-Dist: grpcio (==1.51.3)
 Requires-Dist: protobuf (==4.22.4)
 
 Industrial Agent Management System
 ==================================
```

## Comparing `iams-0.7.6.dist-info/RECORD` & `iams-0.7.7.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,28 +1,28 @@
-iams/__init__.py,sha256=2PlA5QAMED4-L7S3k8xxY6q8CTibcZLgw-QGbkZ1hjY,1954
+iams/__init__.py,sha256=FoZCIiL2sICnntyX6NFsivkR34DsfYSazK5d3pnBT-4,1954
 iams/agent.py,sha256=0UX_joRmaBnLcmVJnD1aNEa1gnd9wB2teAbhUKdoeAU,8055
 iams/ca.py,sha256=IuhgByWBI7UDCxey4I2rIXmiJSK6-Lf2zChDBqdjfv0,3050
 iams/constants.py,sha256=DX9hXxN9XLCit7LXezFh2NPVqZAeo50q0AvHhDggseI,175
 iams/df.py,sha256=goOofsoOt_DhJts0l4EiDeXhZIMo8CPRrktZr9ym4HQ,579
 iams/exceptions.py,sha256=DGC1NEY7u3TSIhfOS1z4x1ZU3LHSzUVxaFo2fUOOxk0,682
 iams/helper.py,sha256=L1SsYgR5o4szZ683Z9LODIQqkOwAB2_9RBbeOTDcPIk,2815
 iams/runtime.py,sha256=ix9vczOTbaz4hEhpGBKui_AhgsJELMo4zlI0auHNCx8,17134
 iams/server.py,sha256=Lc3Uri_jIG-w4lNGG4r-oY5yZnOZ-A_7BJDQRB5WvIo,5370
 iams/servicer.py,sha256=I2Km7OOc5dNtZMPCJqOn8BfKlBAbwewg5v4iz0ab16A,9282
 iams/simulation.py,sha256=e9KI1IZ1xsuXet5PyhpOv8F5LrcrdRvEirByoUCDxBc,10491
 iams/stub.py,sha256=CFW6H6Ppuyx4Ok8wXw-NXcOJ4sDIb0_kX5-OSg_Abfc,3848
 iams/aio/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-iams/aio/grpc.py,sha256=xTkb_kDmf_HVQHVf-eeYofoOP7ga_pLkLixdUtOCFJI,14395
+iams/aio/grpc.py,sha256=dKhphDWqxu6hoDxbVcoA_toS2iFzVYC-by-jGGaibMo,14967
 iams/aio/influx.py,sha256=d-7eTj73_cruaCfkIBv3QTkF1L9NJYt4MpeLgIihj3s,4102
 iams/aio/interfaces.py,sha256=Kd0EB98dSTOZebqbk0J5dbqhPfjnKOinVHQVgpWdoow,4768
 iams/aio/manager.py,sha256=tyBimFzlYqT1GEeddpfYqkhQubNWBvDBmz8ojyJQ3iI,5060
 iams/aio/mqtt.py,sha256=jyLXrcp8M8HRtAXXWgZ4xFFzl1MFP7TzaYwzHYZ2PEY,4938
 iams/aio/opcua.py,sha256=JbeLq0urIb32lKDK087fE1mgfUh4JJ0LZGYMu1b5SBc,12569
 iams/aio/tcp.py,sha256=xivgZ31ZznzeCr3NSlDOiNUkvoopZnqulI5gNHlydbg,5976
-iams/aio/zeebe.py,sha256=QTb75OaAWHjDHVy5Z747Wnl16HYojvEBUdCtCI187Vw,8378
+iams/aio/zeebe.py,sha256=uwMJFKmkR6Zg3fF_nfZwg3odpD8uTg2BIN8LGvYwY04,9911
 iams/interfaces/__init__.py,sha256=YeVl0y_EC8HZgVk6jKnQnIEM5lVjUGgp5WB2s1Ge6kg,755
 iams/interfaces/ca.py,sha256=rCmQuzhlkl3-_BGQOB2jOgZ89MzT91gjPRzpJP1u74o,1097
 iams/interfaces/channel.py,sha256=4dvyKQong58TBdY04mEDvKly-SpJdA6J4abCCbxvJEc,1920
 iams/interfaces/df.py,sha256=QC8ot5cmILbmeY0DbNtSOkMnEL54Heqdrm6yyxt1yRU,1155
 iams/interfaces/plugin.py,sha256=hzSBTjVMMbeXP6uncV3sHhuPhynMCQmnrOuWSLW2LGQ,2133
 iams/interfaces/runtime.py,sha256=JRxDYs_OJE_Bd7pJlb6J5p-vHKzbPcXMdoGtl0cw5vc,2301
 iams/interfaces/scheduler.py,sha256=qubo9eHUt7vvk9TxBdb0cWl2eEbXOjJxC5IuciJYp4c,21681
@@ -35,14 +35,16 @@
 iams/plugins/fluentd/plugin.py,sha256=TxbEWTAv5SyDoeecKz0CdbHF6pas2b4B0ny2eUPnH30,967
 iams/plugins/influxdb/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 iams/plugins/influxdb/plugin.py,sha256=dhQ4evZdb-XUqS6kus9Y6zTX29dTX4ROX54elyhYz48,1770
 iams/plugins/mqtt/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 iams/plugins/mqtt/plugin.py,sha256=HJ1ZAVcfK3qyX4zprgmRdImwMaO0Y3xvIMptnTB8nCU,938
 iams/plugins/sentry/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 iams/plugins/sentry/plugin.py,sha256=rHTTa9gdE9iJ3yBdX5aXjppp0-SZSJxIdFKAN0kZ5fg,712
+iams/plugins/zeebe/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+iams/plugins/zeebe/plugin.py,sha256=XzjQZW6qvB6oZhRWPAmt-YzuVlZjIHqSMC54fAtuMcs,933
 iams/proto/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 iams/proto/agent_pb2.py,sha256=PlPyZ4xtDgkEpSWucFD3Z74Vfg7_0poxcc-uCXQe3v4,3388
 iams/proto/agent_pb2_grpc.py,sha256=FsA-Y1GAoiWZsIeNHoG7s_7E5cd-Y9fk58fz_0hsSEg,9972
 iams/proto/ca_pb2.py,sha256=P7Tec2aV142EVaCrp8iBqnzAwyRUkaukm9HJU_CYLbs,1350
 iams/proto/ca_pb2_grpc.py,sha256=g57kMMplD1C1TjKSwuPaUNw05Gzq0mN3PkuStbECInA,2396
 iams/proto/df_pb2.py,sha256=BXo2P-mfBeliu7UgkrMObwdNhHSsxX1dMzcnqbVZIOo,944
 iams/proto/df_pb2_grpc.py,sha256=8hargmtXc4fWNZl6CG3GaVOslw-gmiIv_32kNG_nEoo,1027
@@ -53,13 +55,13 @@
 iams/utils/grpc.py,sha256=zEHJ5H_-uWiOisFM-0uikZjThDC3xK78znqD5gFumeQ,6693
 iams/utils/outliner.py,sha256=x1QyqhAoHlRBbYfENz8ATcXKGdzLxZ3t9i2iYxFZ77s,824
 iams/utils/plotting.py,sha256=X3BWADnSo2csdWZAx0H0D3TrzzmpTpO3UL4mgmhnMBY,4273
 iams/utils/plugins.py,sha256=W47W7PftNy8GcrPLxRXLKoSBb0O1AAbGZDJkZQIHHog,1905
 iams/utils/scheduler.py,sha256=X8I22KQvnn4VNKWsgPqOi0P60kYqQ64Z0Jvp5rKDMbY,23518
 iams/utils/simulation.py,sha256=FO1frB1Z8s3K2yt0SE7CiGPdrO9s3VPhY1QWVJ6QyoA,184
 iams/utils/ssl.py,sha256=yQYUMoQsH58ROfWrTRvp2eHWqryN3PAZYZPGaUkbt8E,898
-iams-0.7.6.dist-info/LICENSE,sha256=HyVuytGSiAUQ6ErWBHTqt1iSGHhLmlC8fO7jTCuR8dU,16725
-iams-0.7.6.dist-info/METADATA,sha256=XUMWboEFbSaKmYYvHj_irpiZR6wU0GiZL7dbXCSjXvY,4270
-iams-0.7.6.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-iams-0.7.6.dist-info/entry_points.txt,sha256=TYViPuB2BoccGBEEuPms1Jz8QDZ5JEVAQwtfv8zFdAo,120
-iams-0.7.6.dist-info/top_level.txt,sha256=kgw0tsIgBX1M96gfFqM78pqDiBkP9nBI0iLGkkDbwIk,5
-iams-0.7.6.dist-info/RECORD,,
+iams-0.7.7.dist-info/LICENSE,sha256=HyVuytGSiAUQ6ErWBHTqt1iSGHhLmlC8fO7jTCuR8dU,16725
+iams-0.7.7.dist-info/METADATA,sha256=VCBcnJqV9TLRqQpgIE-A97URaunfgQHcyXEhlbm4bPI,4220
+iams-0.7.7.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+iams-0.7.7.dist-info/entry_points.txt,sha256=TYViPuB2BoccGBEEuPms1Jz8QDZ5JEVAQwtfv8zFdAo,120
+iams-0.7.7.dist-info/top_level.txt,sha256=kgw0tsIgBX1M96gfFqM78pqDiBkP9nBI0iLGkkDbwIk,5
+iams-0.7.7.dist-info/RECORD,,
```

